#get tax file and remove only taxids and taxonomy - in real time this will have to be taxid and empty up to species
#run format for itsonedb
# get .taxid output and uplift
#paste back original IDs to uplift
#remove any completely empt tax lines from uplift
#paste IDs from new uplift to replace first column of taxids
#remove empty ;p__;c__;o__; from new uplift
#run make otu
#run clean fasta

#run mapseq clustering
#rename files


# -------------------------------------------------------------
# Chris edits

# Downloaded UNITE_public_all_29.11.2022.fasta.gz from website, which is the "Full UNITE+INSD" dataset, all eukaryotes, 8,380,474 sequences
# https://doi.plutof.ut.ee/doi/10.15156/BIO/2483926
# wget https://files.plutof.ut.ee/public/orig/1A/C1/1AC1288ECCCC67B566050AEEF93A8CC298337B408A24C3E49E17ED28A33AE1BB.gz

# Split the header_ids and the taxonomy into tab-separated .taxid file
# grep ">" UNITE_public_all_29.11.2022.fasta.subset | cut -d"|" -f1-2 | sed 's/|/\t/g' | sed 's/>//' | sed 's/k__/sk__Eukaryota;k__/g' > UNITE_public_all_29.11.2022.fasta.subset.taxid 

# Remove incertae_sedis + anything without a phylum
# sed 's/g__.*_Incertae_sedis/g__/g' UNITE_public_all_29.11.2022.fasta.subset.taxid | sed 's/f__.*_Incertae_sedis/f__/g' | sed 's/c__.*_Incertae_sedis/c__/g' | sed 's/p__.*_Incertae_sedis/p__/g' | sed 's/k__.*_Incertae_sedis/k__/g' | grep -v "p__;" > UNITE_public_all_29.11.2022.fasta.subset.taxid.rm_sedis

# Clean fasta headers
# sed 's/|.*//g' UNITE_public_all_29.11.2022.fasta.subset > UNITE_public_all_29.11.2022.fasta.subset.clean

# Run make_otu_file_unite.py
# taxfile = open("UNITE_public_all_29.11.2022.fasta.subset.taxid.rm_sedis", "r")
# otufile = open("UNITE_v8_all.otu", "w")